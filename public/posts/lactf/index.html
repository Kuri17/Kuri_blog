<!doctype html><html lang=en dir=auto><head><script src="/kuri_blog/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=kuri_blog/livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="noindex, nofollow"><title>Lactf2024 | Kuri</title>
<meta name=keywords content="crypto"><meta name=description content="lactf2024 writeup"><meta name=author content><link rel=canonical href=http://localhost:1313/kuri_blog/posts/lactf/><link crossorigin=anonymous href=/kuri_blog/assets/css/stylesheet.249e0ef142d467aafb133cf4c591a694d6117d1a1744e6a0b019940fd7edaba2.css integrity="sha256-JJ4O8ULUZ6r7Ezz0xZGmlNYRfRoXROagsBmUD9ftq6I=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/kuri_blog/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=http://localhost:1313/kuri_blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/kuri_blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/kuri_blog/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/kuri_blog/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/kuri_blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/kuri_blog/posts/lactf/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css integrity=sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js integrity=sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js integrity=sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa crossorigin=anonymous onload=renderMathInElement(document.body)></script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/kuri_blog/ accesskey=h title="Kuri (Alt + H)">Kuri</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=http://localhost:1313/kuri_blog/categories/ title=categories><span>categories</span></a></li><li><a href=http://localhost:1313/kuri_blog/tags/ title=tags><span>tags</span></a></li><li><a href=http://localhost:1313/kuri_blog/archives title=Archive><span>Archive</span></a></li><li><a href=http://localhost:1313/kuri_blog/search title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Lactf2024
<span class=entry-hint title=Draft><svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h1><div class=post-description>lactf2024 writeup</div><div class=post-meta><span title='2024-02-22 22:17:33 +0900 JST'>February 22, 2024</span></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#holyt141-solves--422-points aria-label="hOlyT(141 solves / 422 points)">hOlyT(141 solves / 422 points)</a><ul><li><a href=#code aria-label=code>code</a></li><li><a href=#adivce aria-label=adivce>adivce</a></li><li><a href=#solution aria-label=solution>solution</a></li></ul></li></ul></div></details></div><div class=post-content><p>解けたのはh0lyTの1問のみ．平方剰余とCRT(中国剰余定理)を使ったいい問題だった．</p><h2 id=holyt141-solves--422-points>hOlyT(141 solves / 422 points)<a hidden class=anchor aria-hidden=true href=#holyt141-solves--422-points>#</a></h2><h3 id=code>code<a hidden class=anchor aria-hidden=true href=#code>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-0-1><a class=lnlinks href=#hl-0-1> 1</a>
</span><span class=lnt id=hl-0-2><a class=lnlinks href=#hl-0-2> 2</a>
</span><span class=lnt id=hl-0-3><a class=lnlinks href=#hl-0-3> 3</a>
</span><span class=lnt id=hl-0-4><a class=lnlinks href=#hl-0-4> 4</a>
</span><span class=lnt id=hl-0-5><a class=lnlinks href=#hl-0-5> 5</a>
</span><span class=lnt id=hl-0-6><a class=lnlinks href=#hl-0-6> 6</a>
</span><span class=lnt id=hl-0-7><a class=lnlinks href=#hl-0-7> 7</a>
</span><span class=lnt id=hl-0-8><a class=lnlinks href=#hl-0-8> 8</a>
</span><span class=lnt id=hl-0-9><a class=lnlinks href=#hl-0-9> 9</a>
</span><span class=lnt id=hl-0-10><a class=lnlinks href=#hl-0-10>10</a>
</span><span class=lnt id=hl-0-11><a class=lnlinks href=#hl-0-11>11</a>
</span><span class=lnt id=hl-0-12><a class=lnlinks href=#hl-0-12>12</a>
</span><span class=lnt id=hl-0-13><a class=lnlinks href=#hl-0-13>13</a>
</span><span class=lnt id=hl-0-14><a class=lnlinks href=#hl-0-14>14</a>
</span><span class=lnt id=hl-0-15><a class=lnlinks href=#hl-0-15>15</a>
</span><span class=lnt id=hl-0-16><a class=lnlinks href=#hl-0-16>16</a>
</span><span class=lnt id=hl-0-17><a class=lnlinks href=#hl-0-17>17</a>
</span><span class=lnt id=hl-0-18><a class=lnlinks href=#hl-0-18>18</a>
</span><span class=lnt id=hl-0-19><a class=lnlinks href=#hl-0-19>19</a>
</span><span class=lnt id=hl-0-20><a class=lnlinks href=#hl-0-20>20</a>
</span><span class=lnt id=hl-0-21><a class=lnlinks href=#hl-0-21>21</a>
</span><span class=lnt id=hl-0-22><a class=lnlinks href=#hl-0-22>22</a>
</span><span class=lnt id=hl-0-23><a class=lnlinks href=#hl-0-23>23</a>
</span><span class=lnt id=hl-0-24><a class=lnlinks href=#hl-0-24>24</a>
</span><span class=lnt id=hl-0-25><a class=lnlinks href=#hl-0-25>25</a>
</span><span class=lnt id=hl-0-26><a class=lnlinks href=#hl-0-26>26</a>
</span><span class=lnt id=hl-0-27><a class=lnlinks href=#hl-0-27>27</a>
</span><span class=lnt id=hl-0-28><a class=lnlinks href=#hl-0-28>28</a>
</span><span class=lnt id=hl-0-29><a class=lnlinks href=#hl-0-29>29</a>
</span><span class=lnt id=hl-0-30><a class=lnlinks href=#hl-0-30>30</a>
</span><span class=lnt id=hl-0-31><a class=lnlinks href=#hl-0-31>31</a>
</span><span class=lnt id=hl-0-32><a class=lnlinks href=#hl-0-32>32</a>
</span><span class=lnt id=hl-0-33><a class=lnlinks href=#hl-0-33>33</a>
</span><span class=lnt id=hl-0-34><a class=lnlinks href=#hl-0-34>34</a>
</span><span class=lnt id=hl-0-35><a class=lnlinks href=#hl-0-35>35</a>
</span><span class=lnt id=hl-0-36><a class=lnlinks href=#hl-0-36>36</a>
</span><span class=lnt id=hl-0-37><a class=lnlinks href=#hl-0-37>37</a>
</span><span class=lnt id=hl-0-38><a class=lnlinks href=#hl-0-38>38</a>
</span><span class=lnt id=hl-0-39><a class=lnlinks href=#hl-0-39>39</a>
</span><span class=lnt id=hl-0-40><a class=lnlinks href=#hl-0-40>40</a>
</span><span class=lnt id=hl-0-41><a class=lnlinks href=#hl-0-41>41</a>
</span><span class=lnt id=hl-0-42><a class=lnlinks href=#hl-0-42>42</a>
</span><span class=lnt id=hl-0-43><a class=lnlinks href=#hl-0-43>43</a>
</span><span class=lnt id=hl-0-44><a class=lnlinks href=#hl-0-44>44</a>
</span><span class=lnt id=hl-0-45><a class=lnlinks href=#hl-0-45>45</a>
</span><span class=lnt id=hl-0-46><a class=lnlinks href=#hl-0-46>46</a>
</span><span class=lnt id=hl-0-47><a class=lnlinks href=#hl-0-47>47</a>
</span><span class=lnt id=hl-0-48><a class=lnlinks href=#hl-0-48>48</a>
</span><span class=lnt id=hl-0-49><a class=lnlinks href=#hl-0-49>49</a>
</span><span class=lnt id=hl-0-50><a class=lnlinks href=#hl-0-50>50</a>
</span><span class=lnt id=hl-0-51><a class=lnlinks href=#hl-0-51>51</a>
</span><span class=lnt id=hl-0-52><a class=lnlinks href=#hl-0-52>52</a>
</span><span class=lnt id=hl-0-53><a class=lnlinks href=#hl-0-53>53</a>
</span><span class=lnt id=hl-0-54><a class=lnlinks href=#hl-0-54>54</a>
</span><span class=lnt id=hl-0-55><a class=lnlinks href=#hl-0-55>55</a>
</span><span class=lnt id=hl-0-56><a class=lnlinks href=#hl-0-56>56</a>
</span><span class=lnt id=hl-0-57><a class=lnlinks href=#hl-0-57>57</a>
</span><span class=lnt id=hl-0-58><a class=lnlinks href=#hl-0-58>58</a>
</span><span class=lnt id=hl-0-59><a class=lnlinks href=#hl-0-59>59</a>
</span><span class=lnt id=hl-0-60><a class=lnlinks href=#hl-0-60>60</a>
</span><span class=lnt id=hl-0-61><a class=lnlinks href=#hl-0-61>61</a>
</span><span class=lnt id=hl-0-62><a class=lnlinks href=#hl-0-62>62</a>
</span><span class=lnt id=hl-0-63><a class=lnlinks href=#hl-0-63>63</a>
</span><span class=lnt id=hl-0-64><a class=lnlinks href=#hl-0-64>64</a>
</span><span class=lnt id=hl-0-65><a class=lnlinks href=#hl-0-65>65</a>
</span><span class=lnt id=hl-0-66><a class=lnlinks href=#hl-0-66>66</a>
</span><span class=lnt id=hl-0-67><a class=lnlinks href=#hl-0-67>67</a>
</span><span class=lnt id=hl-0-68><a class=lnlinks href=#hl-0-68>68</a>
</span><span class=lnt id=hl-0-69><a class=lnlinks href=#hl-0-69>69</a>
</span><span class=lnt id=hl-0-70><a class=lnlinks href=#hl-0-70>70</a>
</span><span class=lnt id=hl-0-71><a class=lnlinks href=#hl-0-71>71</a>
</span><span class=lnt id=hl-0-72><a class=lnlinks href=#hl-0-72>72</a>
</span><span class=lnt id=hl-0-73><a class=lnlinks href=#hl-0-73>73</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>from Crypto.Util.number import getPrime, bytes_to_long
</span></span><span class=line><span class=cl>import random
</span></span><span class=line><span class=cl>def legendre(a, p):
</span></span><span class=line><span class=cl>    return pow(a, (p - 1) // 2, p)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>def tonelli(n, p):
</span></span><span class=line><span class=cl>    q = p - 1
</span></span><span class=line><span class=cl>    s = 0
</span></span><span class=line><span class=cl>    while q % 2 == 0:
</span></span><span class=line><span class=cl>        q //= 2
</span></span><span class=line><span class=cl>        s += 1
</span></span><span class=line><span class=cl>    if s == 1:
</span></span><span class=line><span class=cl>        return pow(n, (p + 1) // 4, p)
</span></span><span class=line><span class=cl>    for z in range(2, p):
</span></span><span class=line><span class=cl>        if p - 1 == legendre(z, p):
</span></span><span class=line><span class=cl>            break
</span></span><span class=line><span class=cl>    c = pow(z, q, p)
</span></span><span class=line><span class=cl>    r = pow(n, (q + 1) // 2, p)
</span></span><span class=line><span class=cl>    t = pow(n, q, p)
</span></span><span class=line><span class=cl>    m = s
</span></span><span class=line><span class=cl>    t2 = 0
</span></span><span class=line><span class=cl>    while (t - 1) % p != 0:
</span></span><span class=line><span class=cl>        t2 = (t * t) % p
</span></span><span class=line><span class=cl>        for i in range(1, m):
</span></span><span class=line><span class=cl>            if (t2 - 1) % p == 0:
</span></span><span class=line><span class=cl>                break
</span></span><span class=line><span class=cl>            t2 = (t2 * t2) % p
</span></span><span class=line><span class=cl>        b = pow(c, 1 &lt;&lt; (m - i - 1), p)
</span></span><span class=line><span class=cl>        r = (r * b) % p
</span></span><span class=line><span class=cl>        c = (b * b) % p
</span></span><span class=line><span class=cl>        t = (t * c) % p
</span></span><span class=line><span class=cl>        m = i
</span></span><span class=line><span class=cl>    return r
</span></span><span class=line><span class=cl>def xgcd(a, b): 
</span></span><span class=line><span class=cl>    if a == 0 : 
</span></span><span class=line><span class=cl>        return 0,1
</span></span><span class=line><span class=cl>             
</span></span><span class=line><span class=cl>    x1,y1 = xgcd(b%a, a) 
</span></span><span class=line><span class=cl>    x = y1 - (b//a) * x1 
</span></span><span class=line><span class=cl>    y = x1 
</span></span><span class=line><span class=cl>     
</span></span><span class=line><span class=cl>    return x,y 
</span></span><span class=line><span class=cl>def crt(a, b, m, n):
</span></span><span class=line><span class=cl>    m1, n1 = xgcd(m, n)
</span></span><span class=line><span class=cl>    return ((b *m * m1 + a *n*n1) % (m * n))
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>def advice(x, p, q):
</span></span><span class=line><span class=cl>    if legendre(x, p) != 1:
</span></span><span class=line><span class=cl>        exit()
</span></span><span class=line><span class=cl>    if legendre(x, q) != 1:
</span></span><span class=line><span class=cl>        exit()
</span></span><span class=line><span class=cl>    x1 = tonelli(x, p) * random.choice([1, -1])
</span></span><span class=line><span class=cl>    x2 = tonelli(x, q) * random.choice([1, -1])
</span></span><span class=line><span class=cl>    y = crt(x1, x2, p, q)
</span></span><span class=line><span class=cl>    return y
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>def main():
</span></span><span class=line><span class=cl>    p = getPrime(1024)
</span></span><span class=line><span class=cl>    q = getPrime(1024)
</span></span><span class=line><span class=cl>    N = p * q
</span></span><span class=line><span class=cl>    e = 65537
</span></span><span class=line><span class=cl>    m = bytes_to_long(b&#34;lactf{redacted?}&#34;)
</span></span><span class=line><span class=cl>    ct = pow(m, e, N)
</span></span><span class=line><span class=cl>    print(f&#34;ct = {ct}&#34;)
</span></span><span class=line><span class=cl>    print(f&#34;N = {N}&#34;)
</span></span><span class=line><span class=cl>    print(f&#34;e = {e}&#34;)
</span></span><span class=line><span class=cl>    while 1:
</span></span><span class=line><span class=cl>        x = int(input(&#34;What do you want to ask? &gt; &#34;))
</span></span><span class=line><span class=cl>        ad = advice(x, p, q)
</span></span><span class=line><span class=cl>        print(ad)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>if __name__ == &#34;__main__&#34;:
</span></span><span class=line><span class=cl>    main()
</span></span></code></pre></td></tr></table></div></div><p>RSA暗号と同じようにメッセージmが暗号化され，暗号文としてctが渡されるので，\(N\)の素因数の\(p,q\)を求める．</p>$$ ct　\equiv m^e \mod N(pq) $$<p>問題には\(p,q\)についての情報を教えてくれる関数adviceが用意されており，任意の値\(x\)を入力し，出力から解読する．adviceは以下の関数．</p><h3 id=adivce>adivce<a hidden class=anchor aria-hidden=true href=#adivce>#</a></h3><ol><li>入力\(x \in pq\)を受け取る．</li><li>\(x \equiv a^2 \mod p, x \equiv b^2 \mod q \)となる\((a,b)\)が存在するとき次のステップに進む</li><li>\(a' \in \{x,p-a\},b' \in \{b,q-b\}\)から，CRTで\(X \in \{0,\dots,pq-1\}\)を出力する．
$$X \equiv a' \mod p $$
$$X \equiv b' \mod q$$</li></ol><h3 id=solution>solution<a hidden class=anchor aria-hidden=true href=#solution>#</a></h3><p>どんな法\(p\)でも，\(1 \equiv 1^2 \mod p\)であるので，\(x\)には\(1\)を選ぶ．そして出力\(X\)は\((a',b')\)の選び方から4通り有るが，</p><ul><li><p>\((a',b') = (1,q-1)\)のとき</p>$$ X+1 \equiv 0 \mod q $$</li><li><p>\((a',b') = (1,q-1)\)のとき</p>$$ X+1 \equiv 0 \mod q$$<p>であるから\(gcd(X +1,N)=(p ~or ~q) \)で\(p,q\)が求まり問題が解ける．</p></li></ul><p>以下解いたコード</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt id=hl-1-1><a class=lnlinks href=#hl-1-1> 1</a>
</span><span class=lnt id=hl-1-2><a class=lnlinks href=#hl-1-2> 2</a>
</span><span class=lnt id=hl-1-3><a class=lnlinks href=#hl-1-3> 3</a>
</span><span class=lnt id=hl-1-4><a class=lnlinks href=#hl-1-4> 4</a>
</span><span class=lnt id=hl-1-5><a class=lnlinks href=#hl-1-5> 5</a>
</span><span class=lnt id=hl-1-6><a class=lnlinks href=#hl-1-6> 6</a>
</span><span class=lnt id=hl-1-7><a class=lnlinks href=#hl-1-7> 7</a>
</span><span class=lnt id=hl-1-8><a class=lnlinks href=#hl-1-8> 8</a>
</span><span class=lnt id=hl-1-9><a class=lnlinks href=#hl-1-9> 9</a>
</span><span class=lnt id=hl-1-10><a class=lnlinks href=#hl-1-10>10</a>
</span><span class=lnt id=hl-1-11><a class=lnlinks href=#hl-1-11>11</a>
</span><span class=lnt id=hl-1-12><a class=lnlinks href=#hl-1-12>12</a>
</span><span class=lnt id=hl-1-13><a class=lnlinks href=#hl-1-13>13</a>
</span><span class=lnt id=hl-1-14><a class=lnlinks href=#hl-1-14>14</a>
</span><span class=lnt id=hl-1-15><a class=lnlinks href=#hl-1-15>15</a>
</span><span class=lnt id=hl-1-16><a class=lnlinks href=#hl-1-16>16</a>
</span><span class=lnt id=hl-1-17><a class=lnlinks href=#hl-1-17>17</a>
</span><span class=lnt id=hl-1-18><a class=lnlinks href=#hl-1-18>18</a>
</span><span class=lnt id=hl-1-19><a class=lnlinks href=#hl-1-19>19</a>
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>from Crypto.Util.number import long_to_bytes
</span></span><span class=line><span class=cl>a = 17831104667040256134725887251427780309283441190346378241363820041577227275015801947889351608323543022862201231205425355290220006633567994093510271341296137236696435486220210052887153794743228135603531011013817226919624495642090379006823492988501642462491665647285840701843758122419384518395935175111969431981176852184961902749819593573017708973408100060762005631607410042285600792954074826599343773206465846004997125247332792765111462262606314067259767823386343138746280621268625953047895333695773948796251064112811522554255832429054369092856990234149099315668149570501794323907590910167206485076585099237050507816158
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>b=5287777601238293523981811494581220691303194637423961140491216223083428308956095244834202549311570881496889752712676367619031571275642899318497063185249821345647331101077718320085534011766574399534626275869397780756135151510387353887061619044081762336730157777890978513661037167287196170717083630998547728678442124653719323218496331423510274573038831528686967059211961114374256096552045957173457049642231463409924134243522665941512000838223624978949908822912588169844952533849109925131151795615090030577149003683343962388502388786278395259552288577776773741360197776419851637543495068989503487348052288499709046665144
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>c=12543327065801962610744075756846559617980246552922417100872603818493798966059706703055149059011972141365311478492748987671188435357925094775013208156046315891049104385142491732801619782976653736068904735144419446163489344131703025119761873944419880125761507869394862188182720955132188347678851544113421703302734727531242579531323262149507434400369268532075038572395448927911344696402028869425886723564234382595072991003810126823599461424382689088309859000473754968901328087419516027916743538080683918219102060429467560165753443642775973833304701656372325574307951794081942686364095841177702997728532810737341461151015
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ct =7795478703951910298760800512251016604742954197898050479871934501928567145784802604542002268080404992780678217646124951840673797270491710309688112924721561151731605873112953711785868170966477869814463719384874577110299248963713396172759754647405773964179242806311505685143222093888093347835985735639754440152848146516109884968142336041568834166265316368983280221226951298952481486521619997411247561491239782604374151098554182647251791561517307089804991475650432858727962467022168414859936296189874338448996484184334288550871046087698350678567999518807001116688026839842507335016985102010047274042512865191879615627189
</span></span><span class=line><span class=cl>N = 17831104667040256134725887251427780309283441190346378241363820041577227275015801947889351608323543022862201231205425355290220006633567994093510271341296137236696435486220210052887153794743228135603531011013817226919624495642090379006823492988501642462491665647285840701843758122419384518395935175111969431981176852184961902749819593573017708973408100060762005631607410042285600792954074826599343773206465846004997125247332792765111462262606314067259767823386343138746280621268625953047895333695773948796251064112811522554255832429054369092856990234149099315668149570501794323907590910167206485076585099237050507816159
</span></span><span class=line><span class=cl>e = 65537
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>print()
</span></span><span class=line><span class=cl>for i in [a,b,c]:
</span></span><span class=line><span class=cl>    p = gcd(N,i+1)
</span></span><span class=line><span class=cl>    q = N//p
</span></span><span class=line><span class=cl>    d = pow(e,-1,(p-1)*(q-1))
</span></span><span class=line><span class=cl>    print(long_to_bytes(int(pow(ct,int(d),N))))
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/kuri_blog/tags/crypto/>Crypto</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/kuri_blog/>Kuri</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>